var asrc=["http://isz.zlhome.com/upLoad/HouseInfos/2015/3/17/0e86533f-3942-43ed-b18a-30fe30d0090a/1.jpg","http://isz.zlhome.com/upLoad/HouseInfos/12014/12/19/62604e45-2c47-49c4-9a72-bd8ec274cec5/1.jpg","http://isz.zlhomecom/upLoad/HouseInfos/2015/1/4/a1aad13e-70c4-436d-babc-7aac98430bcc/1.jpg","http://isz.zlhome.com/upLoad/HouseInfos/12015/3/18/4b84bcdb-6aa3-4b2e-9b28-f61645d3f0b2/1.jpg","http://isz.zlhome.com/upLoad/HouseInfos/12015/3/21/8bdc72dd-d37b-487f-8529-e281a7baf2f2/1.jpg","http://isz.zlhome.com/upLoad/HouseInfos/12014/11/26/25ec8906-5860-41b7-a326-ed349c46ab56/1.jpg","http://isz.zlhome.com/upLoad/HouseInfos/12014/11/26/35967000-2e54-4856-b5e5-03cdb3256bda/1.jpg"],form=new function(){this.init=function(){for(var t=$api.domAll(".txt-flag"),f=t.length,i={},r=0,u=0,n=0,n=0;n<f;n++)i=$api.byId($api.data(t[n],"target")),$api.addCls(i.parentNode,"pos-r"),r=i.offsetLeft+i.clientWidth-t[n].clientWidth-5,u=i.offsetTop+i.clientHeight-t[n].clientHeight-t[n].clientHeight/2+1,$api.css(t[n],"left:"+r+"px;top:"+u+"px;width:"+t[n].clientWidth+"px")};this.validate=function(n){for(var r=$api.byId(n),u=r.length,i=0,t,i=0;i<u;i++)if(t=r[i],this.check(t)&&!t.validity.valid){if("float"===$api.data(t,"validate-type")){if(!/^[0-9]+([.]{1}[0-9]+){0,1}$/.test(t.value))return common.tip("只能为整数或小数"),t.focus(),!1;continue}return common.tip(t.validationMessage),t.focus(),!1}return!0};this.condition=function(id,fArr){fArr=fArr||$api.byId(id);for(var len=fArr.length,i=0,json=[],_this,i=0;i<len;i++)_this=fArr[i],this.check(_this)&&json.push('"'+_this.name+'":"'+$api.val(_this)+'"');return json=json.join(","),eval("({"+json+"})")};this.clear=function(n,t){for(var u=$api.domAll($api.byId(n),"div[data-form-clear] input"),f=form.clear.get(t),i=0,e=u.length,r,i=0;i<e;i++)r=u[i],this.check(r)&&$api.val(r,f[r.name]);tools.filter.select.trade.init()};this.clear.set=function(n,t){var i=$api.domAll($api.byId(n),"div[data-form-clear] input"),r=form.condition(n,i);$api.setStorage(t,r)};this.clear.get=function(n){return $api.getStorage(n)};this.check=function(n){return n.localName==="textarea"||n.localName==="select"||n.localName==="input"&&n.type!=="button"&&n.type!=="submit"&&n.type!=="reset"}},tools=new function(){var n={event:function(){$api.addEvt(tools.arr,"click",function(){tools.show.call(this)});$api.addEvt(".l-sub-mask","click",function(){tools.hide();$api.hide(this)})}};this.init=function(){this.usage=this.base;this.usage.name="usage";this.base.init.call(this.usage);this.sort=this.base;this.sort.name="sort";this.base.init.call(this.sort);this.filter.init();n.event()};this.current={dom:{}};this.arr=$api.domAll(".btn-nav");this.aParent=$api.domAll(".tools > ul > li");this.base={arr:[],old:{},name:"",init:function(){var n=this;n.arr=$api.domAll(n.name+"-list","li");$api.addEvt(n.arr,"click",function(){var t={key:"",value:""},i;n.old=$api.domAll(this.parentNode,".select");$api.removeCls(n.old,"select");$api.text(n.old,"","this");$api.addCls(this,"select");i=$api.trim($api.text(this));$api.html(this,'<i class="fa fa-select"><\/i>'+i);t.key=$api.data(this,"id");t.value=i;typeof n.changeCallback=="function"&&n.changeCallback(t);tools.close()})}};this.usage={};this.sort={};this.filter={select:{trade:{}},init:function(){var n=this;n.select.trade=new Select({title:"交易类型",show:!1,target:"trade-list",key:"tradeType",value:"selectTrade",html:'<li data-id="0" class="select"><i class="fa fa-select"><\/i>全部<\/li><li data-id="1">出售<\/li><li data-id="2">出租<\/li>',change:function(){var n=$api.val("tradeType");if(n==0||n==1){$api.text("unit","万元");return}$api.text("unit","元/月")}});$api.addEvt("selectTrade","click",function(){n.select.trade.show()});$api.addEvt("btnSearch","click",function(){form.validate(page.tools.form.id)&&($api.setStorage(page.tools.form.saveName,form.condition(page.tools.form.id)),hlist.load.data(0),tools.close())});$api.addEvt("btnClear","click",function(){form.clear(page.tools.form.id,page.tools.form.clearName)});form.clear.set(page.tools.form.id,page.tools.form.clearName)}};this.show=function(){var n=$api.dom(this.parentNode,".ui-item");tools.hide();$api.css(this,"color:#149b70");$api.css($api.dom(this,".fa"),"color:#149b70");$api.show(n);$api.css(".l-sub-mask","height:"+$api.dom(".content").clientHeight+"px");$api.show(".l-sub-mask");n.id=="filter"&&$api.data(n,"status")=="0"&&(form.init(),$api.data(n,"status","1"))};this.hide=function(){for(var n=0,i,t,n=0;n<this.aParent.length;n++)t=this.aParent[n],i=$api.dom(t,".ui-item"),$api.css($api.dom(t,".btn-nav"),"color:#333"),$api.css($api.dom(t,".fa"),"color:#808080"),$api.hide(i)};this.close=function(){setTimeout(function(){$api.dom(".l-sub-mask").click()},500)}},hlist=new function(){"use strict";function u(n){var f=i(n),e=f.length,t=0,u=null,o;if(e>0){for(t=0;t<e;t++)if(f[t].className!="dn"){u=f[t];break}u&&(r(n,u.clientHeight),o=u.clientWidth/1.17,$api.css($api.domAll(".fa-picture"),"font-size:"+o+"px"));return}}function i(n){for(var r=[],t=n.length,i;;)if(t--,i=$api.dom(n[t],"li:nth-child(1) img"),i!=null&&r.push(i),t<=0)break;return r}function r(n,t){for(var i=n.length,r=parseInt(t/3);;)if(i--,$api.css($api.dom(n[i],"li:nth-child(2)"),"height:"+r+"px;line-height:"+r+"px"),$api.css($api.last(n[i],"li:nth-child(2) p"),"top:"+(r+1)+"px"),$api.css(n[i],"height:"+(r*3+5)+"px"),i<=0)break}var n=0,t={event:function(){$api.addEvt($api.dom(".content"),"scroll",function(){(common.top.init(this),n==0)&&this.scrollTop>=this.scrollHeight-this.clientHeight-30&&($api.show("msg"),$api.html($api.byId("msg"),'<img src="/Content/images/load.gif" alt="" />正在加载请稍后 ...'),n=1,hlist.ajax.data.UseageId=$api.val("usage"),t.data(page.list,1))});$api.addEvt("usage","change",function(){n=1;hlist.ajax.data.UseageId=$api.val("usage");$api.html(page.list,"<tbody><\/tbody>");$api.html($api.byId("msg"),"");hlist.ajax.data.Page=0;t.data(page.list)});$api.addEvt(window,"resize",function(){var n=$api.domAll(page.list,"ul");u(n)})},condition:function(){},data:function(t,u){hlist.ajax.data.Page=parseInt(hlist.ajax.data.Page)+1;common.ajax.post({url:hlist.ajax.url,data:hlist.ajax.data,load:{type:u},error:function(){n=0},callback:function(u){if(u.Status!=0){if(n=2,u.Status==1){$api.show("msg");$api.html($api.byId("msg"),'<i class="fa fa-null"><\/i>系统内暂无数据 !');return}common.tip(u.Message);return}for(var h=u.Obj.Data.length,c="gp"+u.Obj.Data[0].Id,w=$api.byId(t),l=$api.dom(".content").clientWidth*.33*.88,a=[],f={},v="",o=0,e=0;e<h;e++)f=u.Obj.Data[e],v=f.TradeType==1?"万元":"元/月",o>=asrc.length&&(o=0),a.push('<ul class="item '+c+'" id="'+f.Id+'">        <li><img src="'+asrc[o]+'" onclick="hlist.open('+f.Id+')" class="dn" /><i class="fa fa-picture" onclick="hlist.open('+f.Id+')" style="font-size:'+(l>150?150:l)+'px"><\/i><\/li>        <li>            <p class="housing-title cb" onclick="hlist.open('+f.Id+')">'+f.Name+"房<\/p>            <p>"+f.CityName+" "+f.AreaName+"<\/p>            <p>"+f.Room+"房 "+f.Hall+"厅 "+f.Acreage+"㎡ "+(f.Direct==null||f.Direct==""?"":f.Direct)+'<\/p>            <p class="pos-a" style="right: 5px;top: 23px;"><span class="price">'+f.Price+"<\/span> "+v+"<\/p>        <\/li>    <\/ul>"),o++;$api.append(w,a.join(""));var y=0,p=$api.domAll("."+c),s=i(p),h=s.length,o=0,b=0;for(e=0;e<h;e++)s[e].onload=function(){$api.removeCls(this,"dn");$api.remove($api.dom(this.parentNode,".fa-picture"));y==0&&(r(p,this.clientHeight),y=1,b=this.clientWidth)},s[e].onerror=function(){};n=0}})}};this.ajax={url:page.ajax.url,data:page.ajax.data};this.load=function(){tools.init();tools.usage.changeCallback=function(n){$api.val("usage",n.Key);hlist.load.data()};tools.sort.changeCallback=function(n){$api.val("orderBy",n.Key);hlist.load.data()};t.event();t.condition();this.load.data();$api.css($api.domAll(".ui-item"),"width:"+$api.offset($api.dom(".content")).w+"px")};this.load.data=function(){hlist.ajax.data.UseageId=$api.val("usage");hlist.ajax.data.Page=0;n=1;$api.html($api.byId(page.list),"");t.data(page.list)};this.open=function(n){window.location.href="/Housing/Detail?id="+n+"&userId="+req.userId+"&source="+page.source}};common.loadCallback=function(){hlist.load()};
//# sourceMappingURL=Common.min.js.map
